<!doctype html>
<html lang="en">
	<head>
		<title>{{ shared.app_info.name }} | Control Panel</title>
		<meta name="description" content="A template application." />
		<link rel="canonical" href="{{ shared.app_info.website_url }}" />
		{% include "_partials/meta.html" %} {% include "_partials/scripts.html" %}
	</head>
	<body>
		{% include "_partials/navbar.html" %}
		<main>
			<div class="container">
				<section class="card flex-col">
					<h1>Manage Users</h1>
					<form>
						<div class="form-control">
							<label for="user_search">Search</label>
							<input
								id="user_search"
								name="q"
								autocomplete="off"
								placeholder="Search for user..."
								hx-select="#user_list"
								hx-target="#user_list"
								hx-trigger="keyup changed delay:200ms"
								hx-get="/admin/users"
								type="text"
							/>
						</div>
					</form>
					<div id="user_list" class="flex-col gap-2">
						<div class="table-responsive">
							{% if users.items.len() > 0 %}
							<table>
								<thead>
									<tr>
										<th>Member Details</th>
										<th class="text-right">Completed</th>
									</tr>
								</thead>
								<tbody>
									{% for user in users.items %}
									<tr hx-get="/admin/users/{{ user.id }}" hx-target="#modal">
										<td>
											<div class="flex nowrap items-center">
												<div class="flex-col items-center gap-1">
													<img
														class="avatar"
														src="{{ user.image_url }}"
														width="48"
														height="48"
														alt="Profile image"
													/>
												</div>
												<div class="flex-col gap-0">
													<div class="flex nowrap items-center gap-1">
														<strong class="line-clamp-2"
															>{{ user.full_name | title }}</strong
														>
														{% if user.role == Role::Admin %}<span
															class="pill admin"
															>Admin</span
														>
														{% endif %} {% if user.role == Role::Royalty
														%}<span class="pill royalty">Royalty</span
														>{% endif %} {% if user.locked %}<span
															class="pill"
															>Locked</span
														>{% endif %}
													</div>
													<div>
														Cheshire {% if let Some(runner_id) =
														user.runner_id %}
														<span class="muted">#{{ runner_id }}</span>
														{% endif %} |
														<a
															style="margin: 2px 0"
															href="mailto:{{ user.email }}"
															>{{ user.email }}</a
														>
													</div>
												</div>
											</div>
										</td>
										<td class="text-right">37</td>
									</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
						<div class="muted text-right text-sm">
							{% if users.total == 1 %} {{ users.total }} user {% else %} {{
							users.total }} users {% endif %}
						</div>
						{% else %}
						<p>No members found.</p>
						{% endif %}
					</div>
				</section>
			</div>
		</main>
		{% include "_partials/footer.html" %}
	</body>
</html>
